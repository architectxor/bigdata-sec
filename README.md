# Отчет по практической работе №3 Настройка и развертываение брокера сообщений Apache Kafka и KSQL DB"

В данной лабораторной работе необходимо установить и настроить сервер Apache Kafka — распределенного брокера сообщений, а также клиента для взаимодействия с ним KSQL, позволяющего делать запросы в SQL-подобной форме.

Для начала необходимо создать отдельного пользователя kafka в системе, и добавить его в группу привеллигированных пользователей, как показано на рисунке 1.

![image](https://user-images.githubusercontent.com/49113443/136513290-b6a3c9d6-2d16-4e84-8036-4b3387d7adf1.png)

Рисунок 1 — Создание системного пользователя для Kafka.

Затем нужно перейти на только что созданного пользователя, как показано на рисунке 2.

![image](https://user-images.githubusercontent.com/49113443/136513313-3522d072-403c-425f-80ce-0fb044a6b67d.png)

Рисунок 2 — Переход на системного пользователя

И загрузить исполняемы файлы Apache Kafka, как показано на рисунке 3.

![image](https://user-images.githubusercontent.com/49113443/136513339-e375b7af-15b4-4980-bfd8-fde248c9c4b8.png)

Рисунок 3 — Загрузка Apache Kafka

Загруженный архив необходимо распаковать в отдельную директорию, как показано на рисунке 4.

![image](https://user-images.githubusercontent.com/49113443/136513398-0c878248-2a9e-4605-88a2-1c52867f31c6.png)

Рисунок 4 — Распаковка исполняемых файлов Kafka

Теперь необходимо открыть конфигурационный файл Kafka сервера, как показано на рисунке 5, и отредактировать его так как показано на рисунках 6 и 7.

![image](https://user-images.githubusercontent.com/49113443/136513447-be9c37ed-4440-465f-bcd6-c166d61171b1.png)

Рисунок 5 — Открытие конфигурационного файла сервера на редактирование

![image](https://user-images.githubusercontent.com/49113443/136513505-51bd0250-275e-4260-ae6f-08142c507bfd.png)

Рисунок 6 — Добавление записи, которая включает автоматическое удаление тем.

![image](https://user-images.githubusercontent.com/49113443/136513539-b3c6007d-2e4a-435e-b7b3-bba126f1fb4d.png)

Рисунок 7 — Указание директории для сохранения логов.

Теперь необходимо создать юниты для Zookeeper’a и Kafka, создав соответсвующие файлы с помощью текстового редактора как показано на рисунках 8 и 9 соответственно.
А затем добавив в них соответсвующее содержание, как показано на рисунках 10 и 11.

![image](https://user-images.githubusercontent.com/49113443/136513596-d08654fa-873f-438f-ba5f-5b047d14d57f.png)

Рисунок  8 — Создание юнита для управления Zookeeper.

![image](https://user-images.githubusercontent.com/49113443/136513625-82451fb1-31c0-4cae-8904-138019605931.png)

Рисунок 9 — Создание юнита для управления Kafka.

![image](https://user-images.githubusercontent.com/49113443/136513654-4872b651-231c-4784-aa6f-c0acb63c8fd0.png)

Рисунок 10 — Содержимое файла zookeeper.service.

![image](https://user-images.githubusercontent.com/49113443/136513683-89bf5aaa-9e22-431a-8043-4eeed2d139d5.png)

Рисунок 11 — Содержимое файла kafka.service.

После того как файлы с юнитами определены, можно запустить Kafka-server, как показано на рисунке 12, и убедиться в том, что он действительно работает.

![image](https://user-images.githubusercontent.com/49113443/136513714-f58daca5-a528-4b24-a9e5-a5c25045f96f.png)

Рисунок 12 — Запуск сервера Kafka.

Для того, чтобы созданные сервисы запускались по умолчанию их необходимо включить, как показано на рисунке 13.

![image](https://user-images.githubusercontent.com/49113443/136513760-852a079c-dfd2-4ed0-b6e1-903fd1f5043b.png)

Рисунок 13 — Запуск сервисов на автозагрузку.

Для установки KSQL используем скрипт, представленный на рисунке 14.

![image](https://user-images.githubusercontent.com/49113443/136513801-e037bb16-30ed-4ca1-b7aa-c9441646334d.png)

Рисунок 14 — Содержимое скрипта установки KSQL

Для его запуска, необходимо добавить учетной записи права на исполнение этого файла, как показано на рисунке 15.

![image](https://user-images.githubusercontent.com/49113443/136513851-94824f9c-e9e2-4e28-97a9-f50395a85508.png)

Рисунок 15 — Запуск скрита установки KSQL.

После того, как скрипт установлен, сервер KSQL необходимо запустить, как показано на рисунке 16.

![image](https://user-images.githubusercontent.com/49113443/136513896-1e12584e-5405-42b3-a222-79f796c6ab20.png)

Рисунок 16 — Запуск  сервера KSQL.

Для работы на локальной машине подойдут настройки по умолчанию, поэтому на рисунке выше вторым аргументом просто указан путь до шаблонного конфигурационного файла сервера KSQL.
Теперь получить доступ ksql-серверу для отправки запросов можно, открыв в новом окне терминал и обратившись к серверу по адресу `0.0.0.0:8088`, как показано на рисунке 17.

![image](https://user-images.githubusercontent.com/49113443/136513973-560922c7-4a6e-4631-94b5-f2768a3dfca2.png)

Рисунок 17 — Интерфейс командной строки сервера KSQL.
